<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Basics of Metaflow | My Site</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/metaflow/basics"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Basics of Metaflow | My Site"><meta data-react-helmet="true" name="description" content="This document introduces the basic concepts of Metaflow. If you are eager to try out Metaflow in practice, you can start with the tutorial. After the tutorial, you can return to this document to learn more about how Metaflow works."><meta data-react-helmet="true" property="og:description" content="This document introduces the basic concepts of Metaflow. If you are eager to try out Metaflow in practice, you can start with the tutorial. After the tutorial, you can return to this document to learn more about how Metaflow works."><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/metaflow/basics"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/metaflow/basics" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/metaflow/basics" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.46a3b292.css">
<link rel="preload" href="/assets/js/runtime~main.04c80e94.js" as="script">
<link rel="preload" href="/assets/js/main.b3cae368.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">My Site</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Welcome to Metaflow for Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/why">Why Metaflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/getting-started/install">getting-started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/internals-of-metaflow/technical-overview">internals-of-metaflow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/metaflow/basics">metaflow</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/metaflow/basics">Basics of Metaflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metaflow/client">Inspecting Flows and Results</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metaflow/data">Loading and Storing Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metaflow/debugging">Debugging with Metaflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metaflow/dependencies">Managing External Libraries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metaflow/failures">Dealing with Failures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metaflow/scaling">Scaling Out and Up</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/metaflow/tagging">Organizing Results</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" tabindex="0" href="/docs/metaflow/visualizing-results/">visualizing-results</a><button aria-label="Toggle the collapsible sidebar category &#x27;visualizing-results&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/introduction/contributing-to-metaflow">introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/metaflow-on-aws/">metaflow-on-aws</a><button aria-label="Toggle the collapsible sidebar category &#x27;metaflow-on-aws&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/going-to-production-with-metaflow/coordinating-larger-metaflow-projects">going-to-production-with-metaflow</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Basics of Metaflow</h1><p>This document introduces the basic concepts of Metaflow. If you are eager to try out Metaflow in practice, you can start with the <a href="/docs/getting-started/tutorials/">tutorial</a>. After the tutorial, you can return to this document to learn more about how Metaflow works.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-structure-of-metaflow-code">The Structure of Metaflow Code<a class="hash-link" href="#the-structure-of-metaflow-code" title="Direct link to heading">â€‹</a></h2><p>Metaflow follows <a href="https://en.wikipedia.org/wiki/Dataflow_programming" target="_blank" rel="noopener noreferrer">the dataflow paradigm</a> which models a program as a directed graph of operations. This is a natural paradigm for expressing data processing pipelines, machine learning in particular.</p><p>We call the graph of operations <strong>a flow</strong>. You define the operations, called <strong>steps</strong>, which are nodes of the graph and contain transitions to the next steps, which serve as edges.</p><p>Metaflow sets some constraints on the structure of the graph. For starters, every flow needs a step called <code>start</code> and a step called <code>end</code>. An execution of the flow, which we call <strong>a run</strong>, starts at <code>start</code>. The run is successful if the final <code>end</code> step finishes successfully.</p><p>What happens between <code>start</code> and <code>end</code> is up to you. You can construct the graph in between using an arbitrary combination of the following three types of transitions supported by Metaflow:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="linear">Linear<a class="hash-link" href="#linear" title="Direct link to heading">â€‹</a></h3><p>The most basic type of transition is <strong>a linear</strong> transition. It moves from one step to another one.</p><p>Here is a graph with two linear transitions:</p><p>![](/assets/assets<em>metaflow</em>-lpjn0yp7r49jrnxca<em>5</em>-lpjrytxto2crix9qi6y_graph_linear %281%29.png)</p><p>The corresponding Metaflow script looks like this:</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> metaflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FlowSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">LinearFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FlowSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">my_var </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hello world&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;the data artifact is: %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">my_var</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;the data artifact is still: %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">my_var</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LinearFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Besides executing the steps <code>start</code>, <code>a</code>, and <code>end</code> in order, this flow creates <strong>a data artifact</strong> called <code>my_var</code>. In Metaflow, data artifacts are created simply by assigning values to instance variables like <code>my_var</code>.</p><p>Data artifacts are available in all steps after they have been created, so they behave as any normal instance variables. An exception to this rule are branches, as explained below.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="branch">Branch<a class="hash-link" href="#branch" title="Direct link to heading">â€‹</a></h3><p>You can express parallel steps with <strong>a branch</strong>. In the figure below, <code>start</code> transitions to two parallel steps, <code>a</code> and <code>b</code>. Any number of parallel steps are allowed. A benefit of a branch like this is performance: Metaflow can execute <code>a</code> and <code>b</code> over multiple CPU cores or over multiple instances in the cloud.</p><p><img src="data:image/png;base64,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" width="529" height="133"></p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> metaflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FlowSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">BranchFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FlowSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">b</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a is %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;b is %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;total is %d&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token builtin">input</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BranchFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Every branch must be joined. The join step does not need to be called <code>join</code> as above but it must take an extra argument, like <code>inputs</code> above.</p><p>In the example above, the value of <code>x</code> above is ambiguous: <code>a</code> sets it to <code>1</code> and <code>b</code> to <code>2</code>. To disambiguate the branches, the join step can refer to a specific step in the branch, like <code>inputs.a.x</code> above. For convenience, you can also iterate over all steps in the branch using <code>inputs</code>, as done in the last print statement in the above <code>join</code> step. For more details, see the section about <a href="/docs/metaflow/basics#data-flow-through-the-graph">data flow through the graph</a>.</p><p>Note that you can nest branches arbitrarily, that is, you can branch inside a branch. Just remember to join all the branches that you create.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="foreach">Foreach<a class="hash-link" href="#foreach" title="Direct link to heading">â€‹</a></h3><p>Static branches like above are useful when you know the branches at the development time. Alternatively, you may want to branch based on data dynamically. This is the use case for <strong>a foreach</strong> branch.</p><p>Foreach works similarly like the branch above but instead of creating named step methods, many parallel copies of steps inside a foreach loop are executed.</p><p>A foreach loop can iterate over any list like <code>titles</code> below.</p><p><img src="data:image/png;base64,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" width="554" height="92"></p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> metaflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FlowSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ForeachFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FlowSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">titles </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;Stranger Things&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       </span><span class="token string" style="color:#e3116c">&#x27;House of Cards&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       </span><span class="token string" style="color:#e3116c">&#x27;Narcos&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foreach</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;titles&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%s processed&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token builtin">input</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ForeachFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The foreach loop is initialized by specifying a keyword argument <code>foreach</code> in <code>self.next()</code>. The <code>foreach</code> argument takes a string that is the name of a list stored in an instance variable, like <code>titles</code> above.</p><p>Steps inside a foreach loop create separate <strong>tasks</strong> to process each item of the list. Here, Metaflow creates three parallel tasks for the step <code>a</code> to process the three items of the <code>titles</code> list in parallel. You can access the specific item assigned to a task with an instance variable called <code>input</code>.</p><p>Foreach loops must be joined like static branches. Note that tasks inside a foreach loop are not named, so you can only iterate over them with <code>inputs</code>. If you want, you can assign a value to an instance variable in a foreach step which helps you to identify the task.</p><p>You can nest foreaches and combine them with branches and linear steps arbitrarily.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-should-be-a-step">What should be a step?<a class="hash-link" href="#what-should-be-a-step" title="Direct link to heading">â€‹</a></h2><p>There is not a single right way of structuring code as a graph of steps but here are some best practices that you can follow.</p><p>Metaflow treats steps as indivisible units of execution. That is, a step either succeeds or fails as a whole. After the step has finished successfully, Metaflow persists all instance variables that were created in the step code, so the step does not have to be executed again even if a subsequent step fails. In other words, you can inspect data artifacts that were present when the step finished but you can not inspect data that were manipulated within a step.</p><p>This makes a step <a href="https://en.wikipedia.org/wiki/Application_checkpointing" target="_blank" rel="noopener noreferrer">a checkpoint</a>. The more granular your steps are, the more control you have over inspecting results and resuming failed runs.</p><p>A downside of making steps too granular is that checkpointing adds some overhead. It would not make sense to execute each line of code as a separate step. Keep your steps small but not too small. A good rule of thumb is that a single step should not take more than an hour to run, preferably much less than that.</p><p>Another important consideration is the readability of your code. Try running</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python myflow.py show</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>which prints out the steps of your flow. Does the overview give you a good idea of your code? If the steps are too broad, it might make sense to split them up just to make the overall flow more descriptive.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-to-define-parameters-for-flows">How to define parameters for flows?<a class="hash-link" href="#how-to-define-parameters-for-flows" title="Direct link to heading">â€‹</a></h2><p>Here is an example of a flow that defines a parameter, <code>alpha</code>:</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> metaflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FlowSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Parameter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ParameterFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FlowSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alpha </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Parameter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;alpha&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token builtin">help</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Learning rate&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      default</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;alpha is %f&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">alpha</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;alpha is still %f&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">alpha</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ParameterFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Parameters are defined by assigning a <code>Parameter</code> object to a class variable. Parameter variables are automatically available in all steps, like <code>alpha</code> above.</p><p>You can set the parameter values on the command line as follows:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python parameter_flow.py run --alpha </span><span class="token number" style="color:#36acaa">0.6</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You can see available parameters with:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python parameter_flow.py run --help</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Parameters are typed based on the type of their default value. If there is no meaningful default for a parameter, you can define it as follows:</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">num_components </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Parameter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;num_components&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                           </span><span class="token builtin">help</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Number of components&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                           required</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                           </span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now the flow can not be run without setting <code>--num_components</code> to an integer value.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="advanced-parameters">Advanced parameters<a class="hash-link" href="#advanced-parameters" title="Direct link to heading">â€‹</a></h3><p>In the example above, <code>Parameters</code> took simple scalar values, such as integers or floating point values. To support more complex values for <code>Parameter</code>, Metaflow allows you to specify the value as JSON. This feature comes in handy if your <code>Parameter</code> is a list of values, a mapping, or a more complex data structure.</p><p>This example allows the user to define a GDP by country mapping as a <code>Parameter</code>:</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> metaflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FlowSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Parameter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> step</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> JSONType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">JSONParameterFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FlowSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gdp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Parameter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;gdp&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token builtin">help</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Country-GDP Mapping&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">JSONType</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    default</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;{&quot;US&quot;: 1939}&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    country </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Parameter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;country&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token builtin">help</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;Choose a country&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        default</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;US&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;The GDP of %s is $%dB&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">country</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gdp</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">country</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JSONParameterFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Execute the code as follows:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python parameter_flow.py run --gdp </span><span class="token string" style="color:#e3116c">&#x27;{&quot;US&quot;: 1}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Parameters can also be used to include local files. See the section on <a href="/docs/metaflow/data#data-in-local-files">IncludeFile</a> for more information.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="data-flow-through-the-graph">Data flow through the graph<a class="hash-link" href="#data-flow-through-the-graph" title="Direct link to heading">â€‹</a></h2><p>As previously mentioned, for <a href="/docs/metaflow/basics#linear">linear</a> steps, data artifacts are propagated and any linear step can access data artifacts created by previous steps using instance variables. In this case, Metaflow can easily determine the value of each artifact by simply taking the value of that artifact at the end of the previous step.</p><p>In a join step, however, the value of artifacts can potentially be set to different values on the incoming branches; the value of the artifact is said to be ambiguous.</p><p>To make it easier to implement a join step after foreach or branch, Metaflow provides a utility function, <code>merge_artifacts</code>, to aid in propagating unambiguous values.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> metaflow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FlowSpec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MergeArtifactsFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FlowSpec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pass_down </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">common </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">b</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">common </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">merge_artifacts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exclude</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;y&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;x is %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pass_down is %s&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pass_down</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;common is %d&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;from_a is %d&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">c</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">d</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conflicting </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">e</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conflicting </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">join2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">merge_artifacts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> include</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;pass_down&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;common&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Only pass_down and common exist here&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">end</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MergeArtifactsFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>In the example above, the <code>merge_artifacts</code> function behaves as follows:</p><ul><li>in <code>join</code>, <code>pass_down</code> is propagated because it is unmodified in both <code>a</code> and <code>b</code>.</li><li>in <code>join</code>, <code>common</code> is also propagated because it is set to the same value in both branches. Remember that it is the value of the artifact that matters when determining whether an artifact is ambiguous; Metaflow uses <a href="/docs/internals-of-metaflow/technical-overview#datastore">content based deduplication</a> to store artifacts and can therefore determine if the value of two artifacts is the same.</li><li>in <code>join</code>, <code>x</code> is handled by the code explicitly <em>prior</em> to the call to <code>merge_artifacts</code> which causes <code>merge_artifacts</code> to ignore <code>x</code> when propagating artifacts. This pattern allows you to manually resolve any ambiguity in artifacts you would like to see propagated.</li><li>in <code>join</code>, <code>y</code> is not propagated because it is listed in the <code>exclude</code> list. This pattern allows you to prevent the propagation of artifacts that are no longer relevant. Remember that the default behavior of <code>merge_artifacts</code> is to propagate all incoming artifacts.</li><li>in <code>join</code>, <code>from_a</code> is propagated because it is only set in one branch and therefore is unambiguous. <code>merge_artifacts</code>will propagate all values even if they are present on only one incoming branch.</li><li>In <code>join2</code>, the <code>include</code> keyword is used and allows you to explicitly specify the artifacts to consider when merging. This is useful when the list of artifacts to exclude is larger than the one to include. You cannot use both an <code>include</code> and <code>exclude</code> list in the same <code>merge_artifacts</code> call. Note also that if an artifact is specified in <code>include</code>, an error will be thrown if it either doesn&#x27;t exist in the current step or doesn&#x27;t exist on one of the inputs <!-- -->(<!-- -->in other words, it is &quot;missing&quot;<!-- -->)<!-- -->. The <code>include</code> parameter is only available in version 2.2.1 or later.</li></ul><p>The <code>merge_artifacts</code> function will raise an exception if an artifact that it should merge has an ambiguous value. Remember that <code>merge_artifacts</code> will attempt to merge all incoming artifacts except if they are already present in the step or have been explicitly excluded in the <code>exclude</code> list.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/metaflow/basics.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/internals-of-metaflow/testing-philosophy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Testing Philosophy</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/metaflow/client"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Inspecting Flows and Results</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-structure-of-metaflow-code" class="table-of-contents__link toc-highlight">The Structure of Metaflow Code</a><ul><li><a href="#linear" class="table-of-contents__link toc-highlight">Linear</a></li><li><a href="#branch" class="table-of-contents__link toc-highlight">Branch</a></li><li><a href="#foreach" class="table-of-contents__link toc-highlight">Foreach</a></li></ul></li><li><a href="#what-should-be-a-step" class="table-of-contents__link toc-highlight">What should be a step?</a></li><li><a href="#how-to-define-parameters-for-flows" class="table-of-contents__link toc-highlight">How to define parameters for flows?</a><ul><li><a href="#advanced-parameters" class="table-of-contents__link toc-highlight">Advanced parameters</a></li></ul></li><li><a href="#data-flow-through-the-graph" class="table-of-contents__link toc-highlight">Data flow through the graph</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.04c80e94.js"></script>
<script src="/assets/js/main.b3cae368.js"></script>
</body>
</html>