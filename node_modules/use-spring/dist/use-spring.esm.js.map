{"version":3,"file":"use-spring.esm.js","sources":["../src/time.ts","../src/config.ts","../src/spring.ts","../src/raf-queue.ts","../src/index.ts"],"sourcesContent":["export function currentTime() {\n  if (typeof window !== \"undefined\") {\n    return performance.now();\n  } else {\n    return 0;\n  }\n}\n","import React from \"react\";\nimport { TaskId } from \"./raf-queue\";\nimport { currentTime } from \"./time\";\n\nexport function useSpringInstance(target: number, config: Config): Instance {\n  const ref = React.useRef<Instance | null>(null);\n  if (ref.current == null) {\n    ref.current = {\n      config: getConfigWithDefaults(target, config),\n      state: getInitialState(target, config)\n    };\n  }\n  return ref.current!;\n}\n\nexport function getConfigWithDefaults(\n  target: number,\n  { stiffness, damping, mass, decimals, teleport }: Config\n): InstanceConfig {\n  return {\n    X: target,\n    k: stiffness ?? 170,\n    c: damping ?? 26,\n    m: mass ?? 1,\n    teleport: teleport ?? false,\n    decimals: decimals ?? 2\n  };\n}\n\nfunction getInitialState(target: number, { from, initialSpeed }: Config) {\n  return {\n    x0: from ?? target,\n    v0: initialSpeed ?? 0,\n    t0: currentTime(),\n    raf: null\n  };\n}\n\nexport type Config = {\n  stiffness?: number;\n  damping?: number;\n  mass?: number;\n  decimals?: number;\n  teleport?: boolean;\n  initialSpeed?: number;\n  from?: number;\n};\n\ntype Instance = {\n  config: InstanceConfig;\n  state: InstanceState;\n};\n\nexport type InstanceConfig = {\n  X: number;\n  k: number;\n  c: number;\n  m: number;\n  teleport: boolean;\n  decimals: number;\n};\n\ntype InstanceState = {\n  x0: number;\n  v0: number;\n  t0: number;\n  raf: TaskId | null;\n};\n","const { sqrt, exp, sin, cos } = Math;\n\nexport function spring({ x0, v0, t0, t, k, c, m, X }: Input): Output {\n  const dx = x0 - X;\n  const dt = (t - t0) / 1000;\n  const radicand = c * c - 4 * k * m;\n  if (radicand > 0) {\n    const rp = (-c + sqrt(radicand)) / (2 * m);\n    const rn = (-c - sqrt(radicand)) / (2 * m);\n    const a = (dx * rp - v0) / (rp - rn);\n    const b = (v0 - dx * rn) / (rp - rn);\n    return {\n      x: X + a * exp(rn * dt) + b * exp(rp * dt),\n      v: a * rn * exp(rn * dt) + b * rp * exp(rp * dt)\n    };\n  } else if (radicand < 0) {\n    const r = -c / (2 * m);\n    const s = sqrt(-radicand) / (2 * m);\n    const a = dx;\n    const b = (v0 - r * dx) / s;\n    return {\n      x: X + exp(r * dt) * (a * cos(s * dt) + b * sin(s * dt)),\n      v:\n        exp(r * dt) *\n        ((b * s + a * r) * cos(s * dt) - (a * s - b * r) * sin(s * dt))\n    };\n  } else {\n    const r = -c / (2 * m);\n    const a = dx;\n    const b = v0 - r * dx;\n    return {\n      x: X + (a + b * dt) * exp(r * dt),\n      v: (b + a * r + b * r * dt) * exp(r * dt)\n    };\n  }\n}\n\ntype Input = {\n  x0: number;\n  v0: number;\n  t0: number;\n  t: number;\n  k: number;\n  c: number;\n  m: number;\n  X: number;\n};\n\ntype Output = {\n  x: number;\n  v: number;\n};\n","import { unstable_batchedUpdates } from \"react-dom\";\nimport { currentTime } from \"./time\";\n\ntype FrameId = number;\ntype TaskIndex = number;\nexport type TaskId = [FrameId, TaskIndex];\ntype TaskFn = (now: number) => any;\n\nlet nextFrameQueue: TaskFn[] = [];\nlet nextFrameId: FrameId | null = null;\n\nexport function queueAnimationFrame(fn: TaskFn): TaskId {\n  const length = nextFrameQueue.push(fn);\n  if (length === 1) {\n    nextFrameId = requestAnimationFrame(runQueue);\n  }\n  return [nextFrameId!, length - 1];\n}\n\nexport function unqueueAnimationFrame([frameId, index]: TaskId) {\n  if (frameId === nextFrameId) {\n    delete nextFrameQueue[index];\n  }\n}\n\nfunction runQueue() {\n  const now = currentTime();\n  const queue = nextFrameQueue;\n  nextFrameQueue = [];\n  unstable_batchedUpdates(() => queue.forEach(task => task && task(now)));\n}\n","import React from \"react\";\nimport {\n  getConfigWithDefaults,\n  useSpringInstance,\n  Config,\n  InstanceConfig\n} from \"./config\";\nimport { spring } from \"./spring\";\nimport { queueAnimationFrame, unqueueAnimationFrame } from \"./raf-queue\";\nimport { currentTime } from \"./time\";\n\n// https://github.com/facebook/react/issues/14927\nconst useLayoutEffect =\n  typeof window !== \"undefined\" ? React.useLayoutEffect : React.useEffect;\n\nexport function useSpring(\n  target: number,\n  config: Config = {}\n): [number, boolean] {\n  const [, forceUpdate] = React.useState();\n  const newConfig = getConfigWithDefaults(target, config);\n  const { state, config: oldConfig } = useSpringInstance(target, config);\n\n  // TODO all springs should use the same t in the same frame\n  const t = currentTime();\n  const { x0, v0, t0 } = state;\n  const { k, c, m, X } = oldConfig;\n  const { x, v } = newConfig.teleport\n    ? { x: X, v: 0 }\n    : spring({ x0, v0, t0, t, k, c, m, X });\n  const moving = isMoving(x, v, t, newConfig);\n\n  useLayoutEffect(() => {\n    Object.assign(oldConfig, newConfig);\n  }, [newConfig.X, newConfig.k, newConfig.c, newConfig.m, newConfig.teleport]);\n\n  useLayoutEffect(() => {\n    state.x0 = x;\n    state.v0 = v;\n    state.t0 = t;\n  }, [x, v, t]);\n\n  useLayoutEffect(() => {\n    const loop = (now: number) => {\n      const { x0, v0, t0 } = state;\n      const { k, c, m, X, decimals } = oldConfig;\n      const { x: nextX } = spring({ x0, v0, t0, t: now, k, c, m, X });\n      if (roundTo(nextX, decimals) !== roundTo(x0, decimals)) {\n        state.raf = null;\n        forceUpdate(now);\n      } else {\n        state.raf = queueAnimationFrame(loop);\n      }\n    };\n    if (moving && state.raf == null) {\n      state.raf = queueAnimationFrame(loop);\n    } else if (!moving && state.raf != null) {\n      unqueueAnimationFrame(state.raf);\n      state.raf = null;\n    }\n  });\n\n  useLayoutEffect(() => {\n    return () => {\n      if (state.raf != null) {\n        unqueueAnimationFrame(state.raf);\n      }\n    };\n  }, []);\n\n  return [roundTo(x, newConfig.decimals), moving];\n}\n\nfunction isMoving(\n  x: number,\n  v: number,\n  t: number,\n  { decimals, X, k, c, m }: InstanceConfig\n) {\n  if (roundTo(x, decimals) !== roundTo(X, decimals)) {\n    return true;\n  }\n\n  const nextT = t + 0.016;\n  const { x: nextX } = spring({ x0: x, v0: v, t0: t, t: nextT, k, c, m, X });\n  return roundTo(nextX, decimals) !== roundTo(X, decimals);\n}\n\nfunction roundTo(x: number, decimals: number) {\n  const p = Math.pow(10, decimals);\n  return Math.round(x * p) / p;\n}\n"],"names":["currentTime","window","performance","now","useSpringInstance","target","config","ref","React","useRef","current","getConfigWithDefaults","state","getInitialState","stiffness","damping","mass","decimals","teleport","X","k","c","m","from","initialSpeed","x0","v0","t0","raf","sqrt","Math","exp","sin","cos","spring","t","dx","dt","radicand","rp","rn","a","b","x","v","r","s","nextFrameQueue","nextFrameId","queueAnimationFrame","fn","length","push","requestAnimationFrame","runQueue","unqueueAnimationFrame","frameId","index","queue","unstable_batchedUpdates","forEach","task","useLayoutEffect","useEffect","useSpring","useState","forceUpdate","newConfig","oldConfig","moving","isMoving","Object","assign","loop","nextX","roundTo","nextT","p","pow","round"],"mappings":"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"}